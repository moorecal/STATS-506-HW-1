---
title: "STATS 506 HW 1"
author: "Calder Moore"
format: pdf
editor: visual
---

# STATS 506 Homework 1

## Problem 1 - Abalone Data

### a)

```{r}
#a)
#Set directory and load data
setwd("C:/Users/moore/Desktop/School/Master/STATS 506/STATS-506-HW-1/abalone")

abalone <- read.csv("abalone.data")

#Rename columns
colnames(abalone)[1:9] <- c("Sex", "Length", "Diameter", "Height", "Whole weight", "Shucked weight", "Viscera weight", "Shell weight", "Rings")
```

### b)

```{r}
#b)
table(abalone$Sex)

```

There are 1,307 females, 1,526 males, and 1,342 infants.

### c) #1

```{r}
#c)

#1)
cov(abalone$Rings, abalone$`Whole weight`)
cov(abalone$Rings, abalone$`Shucked weight`)
cov(abalone$Rings, abalone$`Viscera weight`)
cov(abalone$Rings, abalone$`Shell weight`)
```

Whole weight has the greatest correlation with Rings, with a correlation of 0.855.

### c) #2

```{r}
#2)
cov(abalone$Sex == "F", abalone$`Whole weight`)
cov(abalone$Sex == "M", abalone$`Whole weight`)
cov(abalone$Sex == "I", abalone$`Whole weight`)
```

Being infant has the strongest correlation with Whole weight, with a correlation of -0.128. It is the greatest correlation in terms of magnitude, the correlation is more strongly negative than the others are positive.

### c) #3

```{r}
#3)
max_weights <- c(abalone[which.max(abalone$Rings),]["Whole weight"],
                 abalone[which.max(abalone$Rings),]["Shucked weight"],
                 abalone[which.max(abalone$Rings),]["Viscera weight"],
                 abalone[which.max(abalone$Rings),]["Shell weight"])

max_weights
```

Whole weight is 1.8075, Shucked weight is 0.7055, Viscera weight is 0.3215, Shell weight is 0.475

### c) #4

```{r}
#4)
weight_prop <- sum(abalone$`Viscera weight` > abalone$`Shell weight`)/nrow(abalone)
weight_prop
```

Only ~6.5% of the observations have a Viscera weight larger than their Shell weight.

### d)

```{r}
#d)
cor_F <- c(cov(abalone$Sex == "F", abalone$`Whole weight`),
           cov(abalone$Sex == "F", abalone$`Shucked weight`),
           cov(abalone$Sex == "F", abalone$`Viscera weight`),
           cov(abalone$Sex == "F", abalone$`Shell weight`))

cor_M <- c(cov(abalone$Sex == "M", abalone$`Whole weight`),
           cov(abalone$Sex == "M", abalone$`Shucked weight`),
           cov(abalone$Sex == "M", abalone$`Viscera weight`),
           cov(abalone$Sex == "M", abalone$`Shell weight`))

cor_I <- c(cov(abalone$Sex == "I", abalone$`Whole weight`),
           cov(abalone$Sex == "I", abalone$`Shucked weight`),
           cov(abalone$Sex == "I", abalone$`Viscera weight`),
           cov(abalone$Sex == "I", abalone$`Shell weight`))

sex_weight_table <- rbind(cor_F, cor_M, cor_I)
colnames(sex_weight_table) <- c("Whole weight", "Shucked weight", "Viscera weight", "Shell weight")
rownames(sex_weight_table) <- c("Female", "Male", "Infant")
sex_weight_table
```

### e)

```{r}
#Create subsets of the data that only include the certain sex pairs so that we can run the t-tests for each pair: F and M, F and I, and M and I.

abalone_FM <- subset(abalone, abalone$Sex %in% c("F", "M"))
abalone_FI <- subset(abalone, abalone$Sex %in% c("F", "I"))
abalone_MI <- subset(abalone, abalone$Sex %in% c("M", "I"))

ttest_FM <- t.test(abalone_FM$Rings ~ abalone_FM$Sex)
ttest_FI <- t.test(abalone_FI$Rings ~ abalone_FI$Sex)
ttest_MI <- t.test(abalone_MI$Rings ~ abalone_MI$Sex)

ttest_FM
ttest_FI
ttest_MI
```

The difference in rings between females and males was the smallest. Both females and males had significantly different numbers of rings from infants.